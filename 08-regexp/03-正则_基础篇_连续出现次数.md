# 四.正则元字符----字符(串)连续出现次数表示法   #

上一章介绍表示字符的元字符或序列都只代表一个字符.要表示连续多个字符,正则表达式提供了下表中的元字符(序列):

	元字符	次数下限	次数上限	含义
	?		无		1		可以不出现，也可以只出现一次
		 *	无		无		可以出现无数次，也可以不出现
		+	1		无		可以出现无数次，但至少出现一次
	{n}		n		n		必须出现并只出现n次
	{n,m}	n		m		最少出现n次，最多出现m


讨论:

1.这些元字符(序列)叫”量词”,它作用于它前面紧挨的字符或字符串.作用的范围:可用()标示.如果没有(),那么它只作用前面紧挨的一个字符;如果要作用它前面多个字符,必须用()标明范围.

3.慎用可选项量词

显然,上例中浮点数的正则不能匹配这样表示的浮点数如:”.123”.可能你已经想到用下列表达式了:

	\d*(\.\d+)?

的确它能匹配所有形式的浮点数了.但是由于表达式中整数部分与小数部分都是可选的,这意谓着什么也不匹配,也能匹配成功.也就是说无论目标文本是空字符还是任意字符(串),正则引擎都会报告匹配成功(不过匹配结果都是空值).

4.它们都是贪婪量词,即总是尝试匹配尽可能多的字符.比如:可选项量词"?" 它的下限是0即不匹配,上限是1. 如果有符合要求的字符(串),它则选择匹配一个字符(串),不会选择不匹配.

例:正则表达式

	.*

它总是匹配一行中换行符前所有的文本.

实例:提取科室名

目标文本:

姓名:张三 科室:人事科(科长)

姓名:李四 科室:保卫科(干事)

正则表达式:

	科室:(.*)

  代码:

	Sub testname()
	    Dim reg, mh, s$
	    s = "姓名:张三 科室:人事科(科长)" & vbCrLf & "姓名:李四 科室:保卫科(干事)"
	    Set reg =CreateObject("vbscript.regexp")
	    reg.Pattern = "科室:(.*)"
	    reg.Global = True
	    Set mh = reg.Execute(s)
	    MsgBox mh(0).SubMatches(0)
	    MsgBox mh(1).SubMatches(0)
	End Sub

讨论:

   当用"科室:(.*)"去匹配文本时,在第一行成功匹配到:"科室:"后,正则的(.*)部分将依次匹配到后面跟着的所有字符,直到英文句点不能匹配的换行符.所以括号捕获到的内容是:人事科(科长).

   而Global属性设置为true,表示找到第一个匹配后,只要还有文本没有尝试,那么,它将继续找出其它所有匹配结果. 在这个例子,找到两个匹配分别为mh(0)和mh(1). 其科室名即括号捕获的内容分别保存在这两个匹配的特殊变量$1中,VBA可以利用Match对象的submatches属性提取它们.(提示:如果不明白代码意思,请回到第一篇第二章查阅)

量词中还有一个 {n,} 表示出现n次及以上
