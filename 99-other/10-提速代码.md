$http://club.excelhome.net/thread-509998-1-1.html$



Mid$高速生成长字符串

         大家都知道, &操作符的执行速度是相当慢的,特别是处理长字符串时.当必须重复地在同一变量上附加字符时,有一个基于Mid$命令的技巧可以使用.基本思路就是：预留一个足够长的空间存放操作的结果.下面是应用这个技术的一个例子.
假设要建立一个字符串,它要附加从1开始的10000个整数："1 2 3 4 5 6 7 ... 9999 10000".下面是最简单的实现代码：
`res = ""` 
​	`For i = 1 to 10000`
​	`res = res & Str(i)`
`Next`
         代码虽然简单,但问题也很明显：Res变量将被重分配10000次.下面的代码实现同样的目的,但效果明显好转：
`Dim res As String` 
`Dim i As Long` 
`Dim index As Long` 
`‘预留足够长的缓冲空间`
`res = Space(90000)`
`‘指针变量,指出在哪里插入字符串`
`index = 1`
`‘循环开始`
`For i = 1 to 10000`
​	`substr = Str(i)`
​	`length = Len(substr)`
​	`‘填充字符串的相应区间段数值`
​	`Mid$(res, index, length) = substr`
`‘调整指针变量`
​	`index = index + length`
`Next`
`‘删除多余字符`
`res = Left$(res, index - 1)`

        测试表明：在一个333MHz的计算机上,前段代码执行时间为2.2秒,后者仅仅为0.08秒!代码虽然长了些,可是速度却提高了25倍之多.呵呵,由此看来：代码也不可貌相啊(看样子，代码并不一定短才好) 

